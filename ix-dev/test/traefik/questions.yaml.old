# Define groups to seperate and organize the configuration
groups:
  - name: Network & Proxy Configuration
    description: Configure Network, Ports and Proxy
  - name: Domain and Certificate configuration
    description: Setup your domain and certificate provider
  - name: Storage Configuration
    description: Configure Storage
  - name: Environment Variables and Labels Configuration
    description: Configure Labels & Environment Variables
  - name: Resources Configuration
    description: Configure Resources

# Start creating variables that will be used by the docker-compose.yaml template
questions:
  # Group Network Configuration
  # Set network variable
  - variable: network
    label: ""
    group: Network & Proxy Configuration
    schema:
      type: dict
      attrs:


        - variable: https_redirect
          label: Redirect all http traffic to https
          description: Any incomin traffic over http will be automatically moved to https when enabled
          schema:
            type: boolean
            show_if: [["http_enable", "=", true],["https_enable", "=", true]]
            default: false


  # Group Domain & Cert Configuration
  # Set proxy variable
  - variable: proxy
    label: ""
    group: Domain and Certificate configuration
    schema:
      type: dict
      attrs:
        # Choose a challange, http, tls or dns
        # How to refer from Docker-Compose template: values.proxy.challenge
        - variable: challenge
          label: Proxy Challenge
          schema:
            type: string
            required: true
            default: ""
            enum:
              - value: ""
                description: No Challenge. Just HTTP. **NO HTTPS**
              - value: "http_challenge"
                description: HTTP Challenge. Does http, but with a certificate :) Traefik needs to be accessible over port 80 on your router. **CAN NOT USE THIS WITH HTTPS REDIRECT ENABLED**
              - value: "tls_hallenge"
                description: TLS Challenge. Aqcuire unsigned certificates from letsencrypt. This allows for HTTPS connections to your services without a verified domain.
#              - value: "dns_challenge"
#                description: DNS Challenge. Allows you to get the real certs using your dns provider.
        # Aqcuire e-mail adress for Letsencrypt.
        # How to refer from Docker-Compose template: values.proxy.email
        - variable: email
          label: e-Mail Adress for Letsencrypt
          schema:
            type: string
            show_if: [["challenge", "!=", ""]]
            valid_chars: "^.+@.+\\..+$"
            valid_chars_error: The email address is not valid.
            required: true
            default: ""
        # Set dns provider and configure nessecary
        # How to refer from Docker-Compose template: values.proxy.dns_provider
        - variable: dns_provider
          label: DNS Provider
          schema:
            type: string
            show_if: [["challenge", "=", "dns_challenge"]]
            default: "cloudflare"
            required: true
            enum:
              - value: "cloudflare"
                description: Cloudflare DNS provider
              - value: "custom"
                description: Custom DNS Provider
